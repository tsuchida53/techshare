<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
    "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.rugbyaholic.techshare.common.UserRepository">
	
	<select id="createProfileEditForm" parameterType="java.lang.Long" 
			resultType="com.rugbyaholic.techshare.auth.account.ProfileEditForm">
	<![CDATA[
		SELECT  ZIPCODE         AS zipcode,
		        PREF            AS pref,
		        CITY            AS city,
		        BLDG            AS bldg,
		        TELNO           AS phoneNo,
		        MOBILE_NO       AS mobilePhoneNo,
				USER_ID         AS userId
		FROM    PERSONAL_INFO
		WHERE   USER_ID      =  #{userId}
	]]>
	</select>
	
	<select id="identifyUser" resultType="com.rugbyaholic.techshare.auth.AuthenticatedUser">
	
		select * from users where email = #{email}
	
	</select>
	
	<update id="changeProfile" parameterType="com.rugbyaholic.techshare.auth.AuthenticatedUser">
	<![CDATA[
		UPDATE  USERS
		SET     PASSWORD     =  #{password},
		        PROFILE_IMG  =  #{profileImage.fileName}
		WHERE   ID           =  #{id}
	]]>
	</update>
	
	<update id="updatePersonalInfo" parameterType="com.rugbyaholic.techshare.auth.account.ProfileEditForm">
	<![CDATA[
		UPDATE  PERSONAL_INFO
		SET     ZIPCODE      =  #{zipcode},
		        PREF         =  #{pref},
		        CITY         =  #{city},
		        BLDG         =  #{bldg},
		        TELNO        =  #{phoneNo},
		        MOBILE_NO    =  #{mobilePhoneNo}
		WHERE   USER_ID      =  #{userId}
	]]>
	</update>
	
</mapper>